{% extends "layout.html" %}
{% block main %}

<h2>{{ office['name'] }}<br/></h2>

{% if who['kind'] in ['OPR', 'USR', 'MNR'] %}

<div class="MenuItem"><a href='/offices/{{ office['_id'] }}/edit'>Editar</a></div>

{% endif %}

<p>
Siglas: {{ office['acronym'] }}<br/>
Oficial: {{ office['officer'] }}<br/>
Correo: {{ office['email'] }}<br/>
Tel√©fono: {{ office['phone'] }}<br/>
</p>

<p><strong>Notas:</strong></p>

{{ office['notes'] | safe }}

<ul class="tab">
    <li><a href="#" class="tablinks" 
           onclick="openTab(event, 'requests')">Peticiones</a></li>
    <li><a href="#" class="tablinks" 
           onclick="openTab(event, 'complains')">Denuncias</a></li>
    <li><a href="#" class="tablinks" 
            onclick="openTab(event, 'updates')">Notas</a></li>
</ul>

<div id="requests" class="tabcontent">

    {% if who['kind'] in ['OPR', 'USR', 'MNR'] %}
        <div class="MenuItem"><a href="/requests/new/?office_id={{ office['_id'] }}">Nueva...</a></div>
    {% endif %}

    <ul class="List">
    {% for request in requests %}
        <li class="ListItem">{{ request['ref'] }}. <a href="/requests/{{ request['_id'] }}">{{ request['overview'] }}</a></li>
    {% endfor %}
    </ul>
</div>

<div id="complains" class="tabcontent">
    
    {% if who['kind'] in ['OPR', 'USR', 'MNR'] %}
        <div class="MenuItem"><a href="/complains/new/?office_id={{ office['_id'] }}">Nueva...</a></div>
    {% endif %}

    <ul class="List">
    {% for complain in complains %}
        <li class="ListItem">{{ complain['ref'] }}. <a href="/complains/{{ complain['_id'] }}">{{ complain['overview'] }}</a></li>
    {% endfor %}
    </ul>
</div>

<div id="updates" class="tabcontent">
    
    {% if who['kind'] in ['OPR', 'USR', 'MNR'] %}
        <form action='/updates/new/' method="post">
            <input type="hidden" name="source" value="office">
            <input type="hidden" name="source_id" 
                   value="{{ office['_id'] }}">
            <input class="Inline" type="date" size="8" 
                   name="date" placeholder="Fecha">
            <textarea class="Inline" name="detail" 
                      cols="60" rows="10" placeholder="Detalle"></textarea>
            <button>Agregar</button>
        </form>
    {% endif %}

    <ul class="List">
        {% for update in updates %}
            <li class="ListItem">{{ update['date'] }}: 
                {{ update['detail'] | safe }}</li>
        {% endfor %}
    </ul>
</div>

<script src="{{ url_for('static', filename='tabs.js') }}"></script>

{% endblock %}
